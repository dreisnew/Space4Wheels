{% extends "Space4Wheels/base.html" %}
{% load crispy_forms_tags %}

{% block content %}
    <article class="media content-section">
        <img class="rounded-circle article-img" src="{{ object.author.profile.image.url }}">
        <div class="media-body">
            <div class="article-metadata">
                <a class="mr-2" href="#">{{ object.author }}</a>
                <small class="text-muted">{{ object.date_posted|date:"F d, Y" }}</small>
            </div>
            <h2 class="article-title">{{ object.title }}</h2>
            <p class="article-content">{{ object.content }}</p>
            
            <!-- Add the other attributes/content -->
            <p><strong>Country:</strong> {{ object.country }}</p>
            <p><strong>City:</strong> {{ object.city }}</p>
            <p><strong>Address:</strong> {{ object.address }}</p>
            <p><strong>Price:</strong> {{ object.price }}</p>
            <p><strong>Price Rate:</strong> {{ object.get_price_rate_display }}</p>
            <img src="{{ object.car_space_pics.url }}" alt="Car Space Pics" style="max-width: 300px;">
            <p><strong>Car Space Type:</strong> {{ object.get_car_space_type_display }}</p>
            <p><strong>Map Image:</strong> {{ object.map_image|safe }}</p>
            
            {% if object.additional_notes %}
                <p><strong>Additional Notes:</strong> {{ object.additional_notes }}</p>
            {% endif %}
            
            <p><strong>Status:</strong> {{ object.status }}</p>
            
            <!-- Add more fields as needed -->
            
            {% if user.is_authenticated and user == object.author %}
                <a href="{% url 'post-update' pk=object.pk %}" class="btn btn-secondary">Update</a>
                <a href="{% url 'post-delete' pk=object.pk %}" class="btn btn-danger">Delete</a>
            {% endif %}
            
            {% if user.is_authenticated and user != object.author %}
            <button class="btn btn-primary" data-toggle="modal" data-target="#bookNowModal">Book Now</button>
            {% endif %}
        </div>
    </article>

    <!-- Booking Modal -->
    <div class="modal fade" id="bookNowModal" tabindex="-1" role="dialog" aria-labelledby="bookNowModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="bookNowModalLabel">Book Now</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="POST" class="form">
                        {% csrf_token %}
                        {{ booking_form|crispy }}
                        <button type="submit" class="btn btn-primary">Submit Booking</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
{% endblock content %}
